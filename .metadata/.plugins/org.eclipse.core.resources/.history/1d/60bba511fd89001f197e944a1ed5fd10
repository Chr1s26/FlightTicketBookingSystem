package Dao;


import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import Model.Customer;
import Model.FlightSchedule;
import Model.Seat;
import Model.Ticket;

public class TicketDaoImpl extends AbstractDao<Ticket> {
	
	private FlightScheduleDaoImpl flightScheduleDao = new FlightScheduleDaoImpl();
	private CustomerDaoImpl customerDao = new CustomerDaoImpl();
	private SeatDaoImpl seatDao = new SeatDaoImpl();

	@Override
	public String getTableName() {
		return "TICKETS";
	}

	@Override
	public Ticket convertToObject(ResultSet resultset){
		Ticket ticket = null;
		try {
		int id = resultset.getInt("id");
		int scheduleid = resultset.getInt("schedule_id");
		FlightSchedule flightScheduleid = flightScheduleDao.getById(scheduleid);
		int customerid = resultset.getInt("customer_id");
		Customer cid = customerDao.getById(customerid);
		int seatid = resultset.getInt("seat_id");
		Seat sid = seatDao.getById(seatid);
		double price = resultset.getDouble("price");
		ticket = new Ticket(id, flightScheduleid, cid,sid ,price);}
		catch (Exception e) {
			System.out.print("SQL Exception for : "+e.getMessage());
		}
		return ticket;
	}

	@Override
	public String getInsertQuery() {
		return "INSERT INTO TICKETS (schedule_id,customer_id,seat_id,price) VALUES (?,?,?,?)";
	}

	@Override
	public void prepareParams(PreparedStatement preparedStatement, Ticket ticket) {
		
		try {
			preparedStatement.setInt(1,ticket.getSchedule().getScheduleid());
			preparedStatement.setInt(2,ticket.getCustomer().getCustomerId());
			preparedStatement.setInt(3, ticket.getSeat().getSeatid());
			preparedStatement.setDouble(4, ticket.getTicketprice());
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}

}

	
